{:assets        [{:url "/raw/img/park/slide/background2.jpg" :type "image"}
                 {:url "/raw/img/park/slide/slide.png" :type "image"}
                 {:url "/raw/img/park/slide/side.png" :type "image"}
                 {:url "/raw/audio/l2/a5/L2_A5_Mari.m4a" :type "audio"}

                 {:url "/raw/audio/l2/a5/riddles/ardilla.mp3" :type "audio" :alias "ardilla"}
                 {:url "/raw/audio/l2/a5/riddles/bebe.mp3" :type "audio" :alias "bebe"}
                 {:url "/raw/audio/l2/a5/riddles/casa.mp3" :type "audio" :alias "casa"}
                 {:url "/raw/audio/l2/a5/riddles/cepillo.mp3" :type "audio" :alias "cepillo"}
                 {:url "/raw/audio/l2/a5/riddles/chocolate.mp3" :type "audio" :alias "chocolate"}
                 {:url "/raw/audio/l2/a5/riddles/diamante.mp3" :type "audio" :alias "diamante"}
                 {:url "/raw/audio/l2/a5/riddles/elefante.mp3" :type "audio" :alias "elefante"}
                 {:url "/raw/audio/l2/a5/riddles/flor.mp3" :type "audio" :alias "flor"}
                 {:url "/raw/audio/l2/a5/riddles/gato.mp3" :type "audio" :alias "gato"}
                 {:url "/raw/audio/l2/a5/riddles/gemelos.mp3" :type "audio" :alias "gemelo"}
                 {:url "/raw/audio/l2/a5/riddles/hoja.mp3" :type "audio" :alias "hoja"}
                 {:url "/raw/audio/l2/a5/riddles/iman.mp3" :type "audio" :alias "iman"}
                 {:url "/raw/audio/l2/a5/riddles/jardin.mp3" :type "audio" :alias "jardin"}
                 {:url "/raw/audio/l2/a5/riddles/kimono.mp3" :type "audio" :alias "kimono"}
                 {:url "/raw/audio/l2/a5/riddles/leon.mp3" :type "audio" :alias "leon"}
                 {:url "/raw/audio/l2/a5/riddles/llave.mp3" :type "audio" :alias "llave"}
                 {:url "/raw/audio/l2/a5/riddles/mano.mp3" :type "audio" :alias "mano"}
                 {:url "/raw/audio/l2/a5/riddles/nandu.mp3" :type "audio" :alias "nandu"}
                 {:url "/raw/audio/l2/a5/riddles/nino.mp3" :type "audio" :alias "nino"}
                 {:url "/raw/audio/l2/a5/riddles/oso.mp3" :type "audio" :alias "oso"}
                 {:url "/raw/audio/l2/a5/riddles/pelota.mp3" :type "audio" :alias "pelota"}
                 {:url "/raw/audio/l2/a5/riddles/queso.mp3" :type "audio" :alias "queso"}
                 {:url "/raw/audio/l2/a5/riddles/rana.mp3" :type "audio" :alias "rana"}
                 {:url "/raw/audio/l2/a5/riddles/serpiente.mp3" :type "audio" :alias "serpiente"}
                 {:url "/raw/audio/l2/a5/riddles/web.mp3" :type "audio" :alias "sitio web"}
                 {:url "/raw/audio/l2/a5/riddles/tomate.mp3" :type "audio" :alias "tomate"}
                 {:url "/raw/audio/l2/a5/riddles/uvas.mp3" :type "audio" :alias "uvas"}
                 {:url "/raw/audio/l2/a5/riddles/violin.mp3" :type "audio" :alias "violin"}
                 {:url "/raw/audio/l2/a5/riddles/xilofono.mp3" :type "audio" :alias "xilofono"}
                 {:url "/raw/audio/l2/a5/riddles/yoyo.mp3" :type "audio" :alias "yoyo"}
                 {:url "/raw/audio/l2/a5/riddles/zapato.mp3" :type "audio" :alias "zapato"}]
 :audio         {:mari "/raw/audio/l2/a5/L2_A5_Mari.m4a"}
 :objects       {:background    {:type "background"
                                 :src  "/raw/img/park/slide/background2.jpg"}

                 :slide {:type "image" :width 997 :height 758 :x 200 :y 190
                         :src "/raw/img/park/slide/slide.png"}

                 :slide-side {:type "image" :width 234 :height 497 :x 591 :y 450
                              :src "/raw/img/park/slide/side.png"}

                 :mari          {:type       "animation"
                                 :name       "mari"
                                 :transition "mari"
                                 :anim       "idle"
                                 :start      true
                                 :speed      0.35
                                 :x          1600
                                 :y          580
                                 :width      473
                                 :height     511
                                 :scale-y    0.5
                                 :scale-x    0.5}

                 :box1          {:type       "animation"
                                 :name       "boxes"
                                 :skin       "qwestion"
                                 :scene-name "box1"
                                 :transition "box1"
                                 :x          810
                                 :y          216
                                 :width      671
                                 :height     633
                                 :scale      {:x 0.25 :y 0.25}
                                 :anim       "idle2"
                                 :speed      0.3
                                 :start      true
                                 :loop       true
                                 :states     {:init-position {:x 810
                                                              :y 216}
                                              :hidden        {:type "transparent"}
                                              :visible       {:type "animation"}}
                                 :actions    {:click {:type "action" :id "pick-box-1" :on "click"}}}
                 :box2          {:type       "animation"
                                 :name       "boxes"
                                 :skin       "qwestion"
                                 :scene-name "box2"
                                 :transition "box2"
                                 :x          500
                                 :y          287
                                 :width      671
                                 :height     633
                                 :scale      {:x 0.25 :y 0.25}
                                 :anim       "idle2"
                                 :speed      0.3
                                 :start      true
                                 :loop       true
                                 :states     {:init-position {:x 500
                                                              :y 287}
                                              :hidden        {:type "transparent"}
                                              :visible       {:type "animation"}}
                                 :actions    {:click {:type "action" :id "pick-box-2" :on "click"}}}
                 :box3          {:type       "animation"
                                 :name       "boxes"
                                 :skin       "qwestion"
                                 :scene-name "box3"
                                 :transition "box3"
                                 :x          655
                                 :y          212
                                 :width      671
                                 :height     633
                                 :scale      {:x 0.25 :y 0.25}
                                 :anim       "idle2"
                                 :speed      0.3
                                 :start      true
                                 :loop       true
                                 :states     {:init-position {:x 655
                                                              :y 212}
                                              :hidden        {:type "transparent"}
                                              :visible       {:type "animation"}}
                                 :actions    {:click {:type "action" :id "pick-box-3" :on "click"}}}}
 :scene-objects [["background"] ["slide" "slide-side"] ["mari"] ["box1" "box3" "box2"]]
 :actions       {:start                  {:type "sequence"
                                          :data ["start-activity"
                                                 "clear-instruction"
                                                 "renew-words"
                                                 "mari-voice-welcome"
                                                 "init-state"
                                                 "renew-current-concept"]}

                 :start-activity         {:type "start-activity" :id "slide"}
                 :stop-activity          {:type "stop-activity" :id "slide"}
                 :finish-activity       {:type "sequence-data"
                                         :data [{:type "finish-activity" :id "slide"}
                                                {:type "scene" :scene-id "park"}]}

                 :clear-instruction      {:type "remove-flows" :flow-tag "instruction"}

                 :init-state             {:type "parallel"
                                          :data [{:type "set-variable" :var-name "answer-clickable" :var-value false}]}

                 :renew-words            {:type        "lesson-var-provider"
                                          :provider-id "words-set"
                                          :variables   ["item-1" "item-2" "item-3"]
                                          :shuffled    true
                                          :from        "concepts-group"}

                 :renew-current-concept  {:type "sequence-data"
                                          :data [{:type        "vars-var-provider"
                                                  :provider-id "current-concept"
                                                  :variables   ["current-concept"]
                                                  :from        ["item-1" "item-2" "item-3"]
                                                  :shuffled    true
                                                  :on-end      "finish-activity"}
                                                 {:type      "vars-var-provider"
                                                  :variables ["pair-concept-1" "pair-concept-2"]
                                                  :from      ["item-1" "item-2" "item-3"]
                                                  :shuffled  true
                                                  :from-var  [{:var-name "current-concept" :var-property "concept-name"
                                                               :var-key  "concept-name" :action-property "exclude-property-values"}]}
                                                 {:type      "vars-var-provider"
                                                  :variables ["box1" "box2" "box3"]
                                                  :from      ["current-concept" "pair-concept-1" "pair-concept-2"]
                                                  :shuffled  true}
                                                 {:type "parallel"
                                                  :data [{:type "set-slot" :target "box1" :slot-name "box1" :attachment {:scale-x 4 :scale-y 4 :x 40}
                                                          :from-var [{:var-name "box1" :action-property "image" :var-property "image-src"}]}
                                                         {:type "set-slot" :target "box2" :slot-name "box1" :attachment {:scale-x 4 :scale-y 4 :x 40}
                                                          :from-var [{:var-name "box2" :action-property "image" :var-property "image-src"}]}
                                                         {:type "set-slot" :target "box3" :slot-name "box1" :attachment {:scale-x 4 :scale-y 4 :x 40}
                                                          :from-var [{:var-name "box3" :action-property "image" :var-property "image-src"}]}]}
                                                 {:type     "action"
                                                  :from-var [{:var-name     "current-concept"
                                                              :var-property "riddle"}]}
                                                 {:type "set-variable" :var-name "answer-clickable" :var-value true}]}

                 :reset-boxes            {:type "sequence-data"
                                          :data [{:type "state" :id "hidden" :target "box1"}
                                                 {:type "state" :id "hidden" :target "box2"}
                                                 {:type "state" :id "hidden" :target "box3"}
                                                 {:type "empty" :duration 100}
                                                 {:type "state" :id "init-position" :target "box1"}
                                                 {:type "state" :id "init-position" :target "box2"}
                                                 {:type "state" :id "init-position" :target "box3"}
                                                 {:type "set-skin" :target "box1" :skin "qwestion"}
                                                 {:type "set-skin" :target "box2" :skin "qwestion"}
                                                 {:type "set-skin" :target "box3" :skin "qwestion"}
                                                 {:type "state" :id "visible" :target "box1"}
                                                 {:type "state" :id "visible" :target "box2"}
                                                 {:type "state" :id "visible" :target "box3"}]}

                 :pick-box-1             {:type     "test-value"
                                          :from-var [{:var-name "answer-clickable" :action-property "value1"}]
                                          :value2   true
                                          :success  {:type     "test-value"
                                                     :from-var [{:var-name "box1" :action-property "value1"}
                                                                {:var-name "current-concept" :action-property "value2"}]
                                                     :success  {:type "sequence-data"
                                                                :data [{:type "set-variable" :var-name "current-target" :var-value "box1"}
                                                                       {:type "action" :id "pick-correct"}]}
                                                     :fail     "pick-wrong"}
                                          :fail     {:type "empty" :duration 100}}


                 :pick-box-2             {:type     "test-value"
                                          :from-var [{:var-name "answer-clickable" :action-property "value1"}]
                                          :value2   true
                                          :success  {:type     "test-value"
                                                     :from-var [{:var-name "box2" :action-property "value1"}
                                                                {:var-name "current-concept" :action-property "value2"}]
                                                     :success  {:type "sequence-data"
                                                                :data [{:type "set-variable" :var-name "current-target" :var-value "box2"}
                                                                       {:type "action" :id "pick-correct"}]}
                                                     :fail     "pick-wrong"}
                                          :fail     {:type "empty" :duration 100}}

                 :pick-box-3             {:type     "test-value"
                                          :from-var [{:var-name "answer-clickable" :action-property "value1"}]
                                          :value2   true
                                          :success  {:type     "test-value"
                                                     :from-var [{:var-name "box3" :action-property "value1"}
                                                                {:var-name "current-concept" :action-property "value2"}]
                                                     :success  {:type "sequence-data"
                                                                :data [{:type "set-variable" :var-name "current-target" :var-value "box3"}
                                                                       {:type "action" :id "pick-correct"}]}
                                                     :fail     "pick-wrong"}
                                          :fail     {:type "empty" :duration 100}}

                 :pick-correct           {:type "sequence-data"
                                          :data [{:type "set-variable" :var-name "answer-clickable" :var-value false}
                                                 {:type "parallel"
                                                  :data [{:type "action" :id "mari-voice-correct"}
                                                         {:type "sequence-data"
                                                          :data [{:type "empty" :duration 2500}
                                                                 {:type "action" :id "slide-current-target"}]}]}
                                                 {:type "action" :id "mari-voice-try-another"}
                                                 {:type "action" :id "reset-boxes"}
                                                 {:type "empty" :duration 1000}
                                                 {:type "action" :id "renew-current-concept"}]}

                 :pick-wrong             {:type "sequence-data"
                                          :data [{:type "set-variable" :var-name "answer-clickable" :var-value false}
                                                 {:type "action" :id "mari-voice-wrong"}
                                                 {:type "empty" :duration 1000}
                                                 {:type     "action"
                                                  :from-var [{:var-name     "current-concept"
                                                              :var-property "riddle"}]}
                                                 {:type "set-variable" :var-name "answer-clickable" :var-value true}]}

                 :slide-current-target   {:type "sequence-data"
                                          :data [{:type     "transition"
                                                  :from-var [{:var-name        "current-target"
                                                              :action-property "transition-id"}]
                                                  :to       {:bezier [{:x 770 :y 90} {:x 865 :y 460}]
                                                             :ease   [0.1 0.1] :duration 1.0}}
                                                 {:type     "transition"
                                                  :from-var [{:var-name        "current-target"
                                                              :action-property "transition-id"}]
                                                  :to       {:bezier [{:x 930 :y 560} {:x 795 :y 775} {:x 975 :y 920}]
                                                             :ease   [0.1 0.1] :duration 1.5}}
                                                 {:type "empty" :duration 1000}]}
                 :reset-current-target   {:type "sequence-data"
                                          :data [{:type "state" :id "hidden" :from-var [{:var-name "current-target" :action-property "target"}]}
                                                 {:type "empty" :duration 100}
                                                 {:type "state" :id "init-position" :from-var [{:var-name "current-target" :action-property "target"}]}
                                                 {:type "empty" :duration 100}
                                                 {:type "state" :id "visible" :from-var [{:var-name "current-target" :action-property "target"}]}]}

                 :mari-voice-welcome     {:type "animation-sequence" :target "mari" :track 1 :offset 0.974
                                          :description "Como estas pequeno genio? Estas listo para seguir con tu proxima actividad?
                                                            Primero, vamos a empezar por escuchar atentamente la adivinanza.
                                                            Despues, toca la foto para contestarla! Estas listo para empezar?"
                                          :start 0.974,
                                          :duration 22.612,
                                          :audio "/raw/audio/l2/a5/L2_A5_Mari.m4a",
                                          :data
                                          [{:start 1.704, :end 3.872, :duration 2.168, :anim "talk"}
                                           {:start 4.735, :end 8.275, :duration 3.54, :anim "talk"}
                                           {:start 9.248, :end 15.62, :duration 6.372, :anim "talk"}
                                           {:start 16.505, :end 20.089, :duration 3.584, :anim "talk"}
                                           {:start 21.151, :end 23.342, :duration 2.191, :anim "talk"}]}

                 :mari-voice-correct     {:type        "parallel"
                                          :description "Eso es correcto. Ya lo tienes! Wiiii!"
                                          :data        [{:type "audio" :id "mari" :start 34.714 :duration 5.089}
                                                        {:type "animation-sequence" :target "mari" :track 1 :offset 34.714
                                                         :data [{:start 35.190 :end 38.088 :anim "talk"}
                                                                {:start 38.508 :end 39.504 :anim "talk"}]}]}

                 :mari-voice-wrong       {:type        "parallel"
                                          :description "No, intenta de nuevo."
                                          :data        [{:type "audio" :id "mari" :start 29.581 :duration 3.120}
                                                        {:type "animation-sequence" :target "mari" :track 1 :offset 29.581
                                                         :data [{:start 29.802 :end 30.621 :anim "talk"}
                                                                {:start 31.019 :end 32.457 :anim "talk"}]}]}

                 :mari-voice-try-another {:description "Vamos a intentar otra adivinanza.",
                                          :offset 43.188,
                                          :start 43.188,
                                          :type "animation-sequence",
                                          :duration 3.589,
                                          :audio "/raw/audio/l2/a5/L2_A5_Mari.m4a",
                                          :target "mari",
                                          :track 1,
                                          :data [{:start 43.409, :end 46.506, :duration 3.097, :anim "talk"}]}}
 :triggers      {:start {:on "start" :action "start"}
                 :stop  {:on "back" :action "stop-activity"}}
 :metadata      {:autostart true
                 :prev      "park"}}
